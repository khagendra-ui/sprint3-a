doctype html
html(lang="en")
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    title #{title}
    link(rel="stylesheet", href="/style.css")
    script(src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js")

    script.
      function filterByCategory() {
        const selectedCategory = document.getElementById("categoryFilter").value;
        axios.get(`/donations?category=${selectedCategory}`)
          .then(res => {
            const tbody = document.getElementById("donationTableBody");
            tbody.innerHTML = "";
            res.data.forEach(donation => {
              const row = `
                <tr>
                  <td>${donation.item_name}</td>
                  <td>${donation.item_category}</td>
                  <td>${donation.item_description}</td>
                  <td><img src="${donation.item_image}" alt="${donation.item_name}" width="200" /></td>
                  <td>${donation.added_date}</td>
                </tr>`;
              tbody.innerHTML += row;
            });
          })
          .catch(err => console.error("Error fetching filtered donations:", err));
      }

  body
    #mainPage.main-container
      h1 #{title}

      label(for="categoryFilter") Filter by Category:
      select#categoryFilter(onchange="filterByCategory()")
        option(value="") All
        option(value="clothes") Clothes
        option(value="shoes") Shoes
        option(value="accessories") Accessories
        option(value="bags") Bags

      table(border="1")
        thead
          tr
            th Item Name
            th Category
            th Description
            th Image
            th Added Date
        tbody#donationTableBody
          each donation in donations
            tr
              td #{donation.item_name}
              td #{donation.item_category}
              td #{donation.item_description}
              td: img(src=donation.item_image, alt=donation.item_name, width="200")
              td #{donation.added_date}
